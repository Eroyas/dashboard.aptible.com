import Ember from 'ember';
import SIX_POINT_SCALE from 'diesel/utils/six-point-scale';

const SORT = [
  { title: 'Most Severe', value: 'severity' },
  { title: 'Applied Security Controls', value: 'securityControls.length' },
  { title: 'Title', value: 'title' }
];

export default Ember.Component.extend({
  filters: { search: '', sort: SORT[0], severity: null },

  classNames: ['risk-assessment__filters form-inline'],
  sorts: SORT,
  severities: SIX_POINT_SCALE.slice(1),
  showClear: Ember.computed('filters.search', 'filters.severity', function() {
    let currentSearch = this.get('filters.search') || '';
    let severity = this.get('filters.severity');

    return Ember.$.trim(currentSearch) !== '' || (severity && severity !== '');
  }),

  actions: {
    clear() {
      this.set('filters.sort', 'severity');
      this.set('filters.severity', null);
      this.set('filters.search', '');
    },

    update() {
      let sort = this.$('select.sort').val();
      let severity = parseInt(this.$('select.severity').val(), 10);

      this.set('filters.sort', sort);
      this.set('filters.severity', severity);
    }
 }
});
